---
layout: post
comments: true
title: Creating a two dimensional barcode control for Silverlight 3
excerpt: After using the Starbucks mobile card app for iPhone, I set out to create
  similar 2D barcodes in Silverlight 3.
wordpress_id: 461
wordpress_url: http://www.jeff.wilcox.name/?p=461
imported_categories:
- title: c#
  slug: csharp
  autoslug: c#
- title: silverlight
  slug: silverlight
  autoslug: silverlight
- title: silverlight-toolkit
  slug: silverlight-toolkit
  autoslug: silverlight-toolkit
imported_link_categories: []
tags: []
---
<p><strong>Update 3/26/10: </strong> This also works with Windows Phone applications. <a href="http://www.jeff.wilcox.name/2010/03/windowsphone-barcode/">2D barcodes in Windows Phone applications</a> post.</p>

<p>Thanks to the abundance of .NET class libraries that have been developed over nearly a decade of .NET software development, it’s amazingly easy to add powerful functionality to Silverlight applications by reusing existing code. Within a few hours, I was able to create two-dimensional barcodes in Silverlight – making me really want mobile support, web camera support, and printing (<a href="http://silverlight.uservoice.com/pages/4325-feature-suggestions">submit your Silverlight customer suggestions</a>) for this functionality to be super useful.</p>  <p>My temporary obsession with 2D barcodes came about after I installed the awesome <a href="http://www.techflash.com/seattle/2009/09/starbucks_debuts_apps_for_finding_stores_buying_coffee.html">Starbucks Card Mobile app</a> for my iPhone and drove by the Madison Park Starbucks on my way to Redmond, trying out their sweet mobile payment experience. The app worked great – I can only imagine how nice it will be once I can leave my physical Starbucks card at home!</p>  <p><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; margin-left: 0px; border-left-width: 0px; margin-right: 0px" title="starbucksapp1" border="0" alt="starbucksapp1" src="http://az414997.vo.msecnd.net/wordpress/2009/09/starbucksapp1.jpg" width="321" height="497" />     <br /><em>Note: Image is provided by Starbucks, and not a real bar-code that’ll get you free coffee :-)</em></p>  <p>I’ve heard stories for years about how many countries worldwide are super-high tech, using <a href="http://en.wikipedia.org/wiki/QR_Code">QR two-dimensional barcodes</a> everywhere, but this was my first experience as a regular consumer, other than seeing them on UPS shipping labels, expensive-looking gadgets in stores, and photos of interesting places:</p>  <p><a href="http://www.flickr.com/photos/avlxyz/2740692511/"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="QuickReadLive" border="0" alt="QuickReadLive" src="http://az414997.vo.msecnd.net/wordpress/2009/09/QuickReadLive1.jpg" width="685" height="324" /></a>&#160; <br /><em>Photo by avlxyz', CC-attribution</em></p>  <p>There are so many versions of the QR code standard now that I settled on Version 2, which doesn’t hold as much data as some of the more complex versions – but the library iteself supports them all if you embed a few additional resource files into the assembly.</p>  <p>So what I set and did to get the bare minimum working:</p>  <ul>   <li>Used Joe Stegman’s <a href="http://blogs.msdn.com/jstegman/archive/2008/04/21/dynamic-image-generation-in-silverlight.aspx">EditableImage</a> and <a href="http://blogs.msdn.com/jstegman/archive/2008/04/21/dynamic-image-generation-in-silverlight.aspx">PngEncoder</a> to create a raster image on the client </li>    <li>Found an open-source .NET library that performs at least QR encoding – I found and settled on <a href="http://www.codeproject.com/KB/cs/qrcode.aspx">QRcode on The Code Project</a> site, licensed via the permissive <a href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a> – this work of user ‘twit88’ is the bulk of the awesomeness we’re talking about here </li>    <li>Adapted the library to work with the reduced BCL set (replace ArrayList with generic collections, etc.). I also had to replace some System.Drawing functionality with other equivalents, plus write a quick <a href="http://www.jeff.wilcox.name/2009/09/silverlight-toargb/">ToArgb extension method</a> </li>    <li>Create a simple control, QRBarcode, that has text and barcode color properties </li> </ul>  <p>Here’s the resulting control in use (<strong>click</strong> to <a href="http://www.jeff.wilcox.name/blog/sampleApps/barcode/BarcodeSample.html"><strong>experience the app</strong></a>):</p>  <p><a href="http://www.jeff.wilcox.name/blog/sampleApps/barcode/BarcodeSample.html"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="BarcodeSample[1]" border="0" alt="BarcodeSample[1]" src="http://az414997.vo.msecnd.net/wordpress/2009/09/BarcodeSample1.png" width="685" height="382" /></a> </p>  <p>It was a quick project, so now, I just need some Silverlight mobile – argh! There isn’t much application to a standard Silverlight app today, unless you want to use SaveFileDialog to store the image to the user’s homepage, or let them take a digital picture of the code. But hey, it was fun!</p>  <p>If you download the project, you’ll see that I purposely excluded a lot of the various QA code spec versions from the final assembly, to cut down its size, plus I commented out some of the encode capability – but overall it went together really quickly and is a solid library, for sure.</p>  <p><a href="http://www.jeff.wilcox.name/blog/sampleApps/barcode/SilverlightBarcode.zip"><strong>Download the zipped up solution</strong></a><strong> with everything you need to experiment</strong> (Silverlight 3, C#, 1.1 MB)</p>  <p>Related note: <a href="http://www.codinghorror.com/blog/archives/001292.html">Jeff Atwood posted a neat comparison</a> of data over the years, back in July.</p>
